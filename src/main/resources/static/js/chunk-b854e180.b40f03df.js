(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b854e180"],{"0758":function(t,e,o){},2673:function(t,e,o){"use strict";var i=o("0758"),a=o.n(i);a.a},"4ed9":function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{attrs:{id:"loginFrame"}},[t._m(0),o("div",{attrs:{id:"login"}},[t.show?o("b-form",{on:{submit:t.onSubmit,reset:t.onReset}},[o("b-form-group",{attrs:{id:"userId",label:"ID:","label-for":"userIdInput"}},[o("b-form-input",{attrs:{id:"userIdInput",type:"text",required:"",placeholder:"输入ID"},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),o("b-form-group",{attrs:{id:"password",label:"密码:","label-for":"passwordInput"}},[o("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),o("div",{attrs:{id:"loginStatus"}},[o("span",[t._v(t._s(t.loginStatus))])]),o("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"submit",variant:"primary",size:"md"}},[t._v("登陆\n        ")]),o("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"reset",variant:"danger",size:"md"}},[t._v("重置\n        ")])],1):t._e()],1)])])},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"title"}},[o("h3",[t._v("用户登录")])])}],s=o("f499"),n=o.n(s),c=(o("6b54"),o("96cf"),o("3b8d")),l=o("c0d6"),d={data:function(){return{form:{userId:"",password:""},loginStatus:"",show:!0,hasClicked:!1}},methods:{onSubmit:function(t){var e=this;if(t.preventDefault(),!this.hasClicked){var o=/[0-9]+/;o.test(this.form.userId)?(this.hasClicked=!0,this.loginStatus="登陆中...",this.login().then(function(t){100===t?(e.loginStatus="登陆成功",e.fetchData(),e.form.userId="",e.form.password="",e.loginStatus="",e.hasClicked=!1):500===t?(e.loginStatus="账户尚未激活",e.hasClicked=!1,e.$router.push({name:"activate"})):210===t?(e.loginStatus="请求超时，请重试",e.hasClicked=!1):-999===t?(e.loginStatus="服务器开小差了，请重试",e.hasClicked=!1):(e.loginStatus="ID或密码不正确",e.hasClicked=!1)})):this.loginStatus="ID必须为数字"}},onReset:function(t){var e=this;t.preventDefault(),this.hasClicked||(this.form.userId="",this.form.password="",this.loginStatus="",this.show=!1,this.$nextTick(function(){e.show=!0}))},login:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={userId:this.form.userId,password:this.form.password,platform:"CONSOLE"},o=200,t.next=4,this.axios.post(this.getAPI()+"/login",e,{timeout:15e3}).then(function(t){console.log(t.data),o=t.data},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?o=210:(console.log("post failed"),console.log(t))});case 4:return t.abrupt("return",o);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),fetchData:function(){this.axios.get(this.getAPI()+"/user").then(function(t){localStorage.setItem("user",n()(t.data)),l["a"].commit("setUser")},function(t){console.log("post failed"),console.log(t)})}}},r=d,u=(o("2673"),o("2877")),m=Object(u["a"])(r,i,a,!1,null,"2f9c4756",null);e["a"]=m.exports},6573:function(t,e,o){"use strict";var i=o("b54d"),a=o.n(i);a.a},b54d:function(t,e,o){},db8c:function(t,e,o){"use strict";o.r(e);var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[t._m(0),t._m(1),o("div",{attrs:{id:"new-notice"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-4"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"new-notice-title"}},[t._v("公告标题")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.newNotice.title,expression:"newNotice.title"}],staticClass:"form-control",attrs:{id:"new-notice-title",type:"text","aria-describedby":"inputGroup-sizing-sm"},domProps:{value:t.newNotice.title},on:{input:function(e){e.target.composing||t.$set(t.newNotice,"title",e.target.value)}}})])]),o("div",{staticClass:"col-8"})]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-11"},[o("label",{attrs:{for:"notice-editor"}},[t._v("公告内容")]),o("div",{attrs:{id:"notice-editor"}},[o("froala",{attrs:{tag:"textarea",config:t.froalaConfig},model:{value:t.newNotice.content,callback:function(e){t.$set(t.newNotice,"content",e)},expression:"newNotice.content"}})],1),o("div",{staticClass:"row"},[o("div",{staticClass:"col-10"}),o("div",{staticClass:"col-2"},[o("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.resetNewNotice}},[t._v("重置")]),o("button",{staticClass:"btn btn-primary",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.submitNewNotice}},[t._v("提交")])])])]),o("div",{staticClass:"col-1"})])]),t._m(2),o("div",{attrs:{id:"current-notices"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-11"},[o("table",{staticClass:"table table-hover table-responsive-lg"},[t._m(3),o("tbody",[0===t.currentRecords.length?o("tr",[o("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[t._v("暂无公告")])]):t._e(),t._l(t.currentRecords,function(e,i){return o("tr",[o("th",{attrs:{scope:"row"}},[t._v(t._s(i+1))]),t._l(e,function(e){return o("td",[t._v("\n              "+t._s(e)+"\n            ")])}),o("td",[o("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.changeStatus(i,!0)}}},[t._v("下架")]),o("button",{staticClass:"btn btn-info btn-sm",on:{click:function(e){return t.getNoticeDetail(i,!0)}}},[t._v("详情")])])],2)})],2)])]),o("div",{staticClass:"col-1"})])]),t._m(4),o("div",{attrs:{id:"old-notices"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-11"},[o("table",{staticClass:"table table-hover table-responsive-lg"},[t._m(5),o("tbody",[0===t.oldRecords.length?o("tr",[o("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"5"}},[t._v("暂无公告")])]):t._e(),t._l(t.oldRecords,function(e,i){return o("tr",[o("th",{attrs:{scope:"row"}},[t._v(t._s(i+1))]),t._l(e,function(e){return o("td",[t._v("\n              "+t._s(e)+"\n            ")])}),o("td",[o("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.changeStatus(i,!1)}}},[t._v("公布")]),o("button",{staticClass:"btn btn-info btn-sm",on:{click:function(e){return t.getNoticeDetail(i,!1)}}},[t._v("详情")])])],2)})],2)])]),o("div",{staticClass:"col-1"})])]),o("div",{staticClass:"modal fade",attrs:{id:"noticeModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(6),o("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[t._v("\n          加载中...\n        ")]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"modal-body"},[o("div",{attrs:{id:"modify-notice"}},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-4"},[t._m(7),o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyNotice.noticeId,expression:"modifyNotice.noticeId"}],staticClass:"form-control",attrs:{id:"modify-notice-id",type:"text","aria-describedby":"inputGroup-sizing-sm",readonly:""},domProps:{value:t.modifyNotice.noticeId},on:{input:function(e){e.target.composing||t.$set(t.modifyNotice,"noticeId",e.target.value)}}})]),o("div",{staticClass:"col-4"},[o("div",{staticClass:"form-group"},[t._m(8),o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyNotice.title,expression:"modifyNotice.title"}],staticClass:"form-control",attrs:{id:"modify-notice-title",type:"text","aria-describedby":"inputGroup-sizing-sm"},domProps:{value:t.modifyNotice.title},on:{input:function(e){e.target.composing||t.$set(t.modifyNotice,"title",e.target.value)}}})])]),o("div",{staticClass:"col-4"})]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-4"},[o("strong",[t._v("创建日期：")]),t._v(t._s(t.modifyNotice.createDate))]),o("div",{staticClass:"col-4"},[o("strong",[t._v("更新日期：")]),t._v(t._s(t.modifyNotice.updateDate))]),o("div",{staticClass:"col-4"})]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-12"},[t._m(9),o("div",{attrs:{id:"modify-notice-editor"}},[o("froala",{attrs:{tag:"textarea",config:t.froalaConfigModal},model:{value:t.modifyNotice.content,callback:function(e){t.$set(t.modifyNotice,"content",e)},expression:"modifyNotice.content"}})],1)])]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-10"}),o("div",{staticClass:"col-2"},[o("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.deleteSwitchOn}},[t._v("删除")]),o("button",{staticClass:"btn btn-warning btn-sm",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.submitModifyNotice}},[t._v("修改")])])])])]),t._m(10)])])]),o("div",{staticClass:"modal",attrs:{tabindex:"-1",role:"dialog",id:"delConfirmModal"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-sm",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(11),t._m(12),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.submitDeleteNotice}},[t._v("确定")]),o("button",{staticClass:"btn btn-secondary",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.deleteSwitchOff}},[t._v("取消")])])])])]),o("div",{staticClass:"modal fade",attrs:{id:"loginModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-md",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(13),o("div",{staticClass:"modal-body",attrs:{id:"loginModalBody"}},[o("LoginModal")],1)])])])])},a=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"row"},[o("div",{staticClass:"col-12"},[o("div",{attrs:{id:"panel-title"}},[o("h4",[o("strong",[t._v("公告板")])])])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"new-notice"}},[o("strong",[t._v("公告发布")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"current-notices"}},[o("strong",[t._v("当前展示公告")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("#")]),o("th",{attrs:{scope:"col"}},[t._v("公告标题")]),o("th",{attrs:{scope:"col"}},[t._v("创建日期")]),o("th",{attrs:{scope:"col"}},[t._v("更新日期")]),o("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"old-notices"}},[o("strong",[t._v("过去公告")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("#")]),o("th",{attrs:{scope:"col"}},[t._v("公告标题")]),o("th",{attrs:{scope:"col"}},[t._v("创建日期")]),o("th",{attrs:{scope:"col"}},[t._v("更新日期")]),o("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title",attrs:{id:"infoModalLabel"}},[t._v("公告详情")]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"modify-notice-id"}},[o("strong",[t._v("公告ID")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"modify-notice-title"}},[o("strong",[t._v("公告标题")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("label",{attrs:{for:"modify-notice-editor"}},[o("strong",[t._v("公告内容")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("关闭")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title"},[t._v("删除确认")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-body"},[o("p",[t._v("确认删除公告？该操作不可恢复")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title",attrs:{id:"loginModalLabel"}},[t._v("会话超时")]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],s=o("1157"),n=o.n(s),c=o("4ed9"),l={name:"notice",components:{LoginModal:c["a"]},data:function(){return{froalaConfig:{toolbarButtons:["undo","redo","clearFormatting","|","bold","italic","underline","strikeThrough","|","fontFamily","fontSize","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","insertLink","insertImage","insertTable","|","specialCharacters","insertHR","selectAll","|","print","help","fullscreen"],placeholder:"请填写内容",language:"zh_cn",imageUploadURL:this.getAPI()+"/notice/upload-picture",colorsHEXInput:!1,toolbarSticky:!0,requestWithCredentials:!0},froalaConfigModal:{toolbarButtons:["undo","redo","clearFormatting","|","bold","italic","underline","strikeThrough","|","fontFamily","fontSize","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","insertLink","insertImage","insertTable","|","specialCharacters","insertHR","selectAll","|","print","help","fullscreen"],placeholder:"请填写内容",language:"zh_cn",imageUploadURL:this.getAPI()+"/notice/upload-picture",colorsHEXInput:!1,toolbarSticky:!0,requestWithCredentials:!0,zIndex:1050},newNotice:{title:"",content:""},modifyNotice:{noticeId:"",title:"",content:"",createDate:"",updateDate:""},oldRecords:[],oldRecordId:[],currentRecords:[],currentRecordId:[],hasClicked:!1,loading:!0,modifyIndex:{index:"",onboard:!1}}},computed:{isOnline:function(){return this.$store.getters.getOnline}},watch:{isOnline:function(){this.$store.getters.getOnline&&(n()("#loginModal").modal("hide"),this.getNoticeList())}},methods:{getNoticeList:function(){this.getCurrentList(),this.getOldList()},getCurrentList:function(){var t=this;this.checkSession().then(function(e){e?t.axios.get(t.getAPI()+"/notice/current-list").then(function(e){t.currentRecords=[],t.currentRecordId=[];for(var o=0;o<e.data.length;o++){var i={noticeTitle:e.data[o].noticeTitle,createDate:t.dateTimeTrim(e.data[o].createDate),updateDate:t.dateTimeTrim(e.data[o].updateDate)};t.currentRecordId.push(e.data[o].noticeId),t.currentRecords.push(i)}},function(t){console.log("Get Failed"),console.log(t)}):n()("#loginModal").modal("show")})},getOldList:function(){var t=this;this.checkSession().then(function(e){e?t.axios.get(t.getAPI()+"/notice/old-list").then(function(e){t.oldRecords=[],t.oldRecordId=[];for(var o=0;o<e.data.length;o++){var i={noticeTitle:e.data[o].noticeTitle,createDate:t.dateTimeTrim(e.data[o].createDate),updateDate:t.dateTimeTrim(e.data[o].updateDate)};t.oldRecordId.push(e.data[o].noticeId),t.oldRecords.push(i)}},function(t){console.log("Get Failed"),console.log(t)}):n()("#loginModal").modal("show")})},getNoticeDetail:function(t,e){var o=this;this.checkSession().then(function(i){var a;i?(n()("#noticeModal").modal("show"),a=e?{noticeId:o.currentRecordId[t]}:{noticeId:o.oldRecordId[t]},o.loading=!0,o.axios.post(o.getAPI()+"/notice/detail",a).then(function(i){o.modifyNotice.noticeId=i.data.noticeId,o.modifyNotice.title=i.data.noticeTitle,o.modifyNotice.content=i.data.noticeContent,o.modifyNotice.createDate=o.dateTimeTrim(i.data.createDate),o.modifyNotice.updateDate=o.dateTimeTrim(i.data.updateDate),o.loading=!1,o.modifyIndex.index=t,o.modifyIndex.onboard=e},function(t){console.log("get notice detail failed"),console.log(t)})):n()("#loginModal").modal("show")})},submitNewNotice:function(){var t=this;this.hasClicked||(this.checkFormat(this.newNotice)?alert("公告标题或内容不能为空"):(this.hasClicked=!0,this.checkSession().then(function(e){if(e){var o={noticeTitle:t.newNotice.title,noticeContent:t.newNotice.content};t.axios.post(t.getAPI()+"/notice/new",o).then(function(e){if(100===e.data.operationStatus){var o={noticeTitle:t.newNotice.title,createDate:t.$moment().format("YYYY-MM-DD HH:mm:ss"),updateDate:t.$moment().format("YYYY-MM-DD HH:mm:ss")};t.oldRecords.unshift(o),t.oldRecordId.unshift(e.data.noticeId),t.resetNewNotice()}},function(t){console.log("notice post failed"),console.log(t)})}else n()("#loginModal").modal("show")}),this.hasClicked=!1))},submitModifyNotice:function(){var t=this;this.hasClicked||(this.checkFormat(this.modifyNotice)?alert("公告标题或内容不能为空"):(this.hasClicked=!0,this.checkSession().then(function(e){if(e){var o={noticeId:t.modifyNotice.noticeId,noticeTitle:t.modifyNotice.title,noticeContent:t.modifyNotice.content};t.axios.post(t.getAPI()+"/notice/modify",o).then(function(e){if(100===e.data){t.modifyNotice.updateDate=t.$moment().format("YYYY-MM-DD HH:mm:ss");var o={noticeTitle:t.modifyNotice.title,createDate:t.modifyNotice.createDate,updateDate:t.modifyNotice.updateDate};t.modifyIndex.onboard?(t.currentRecords.splice(t.modifyIndex.index,1,o),t.currentRecordId.splice(t.modifyIndex.index,1,t.modifyNotice.noticeId)):(t.oldRecords.splice(t.modifyIndex.index,1,o),t.oldRecordId.splice(t.modifyIndex.index,1,t.modifyNotice.noticeId)),alert("修改成功")}else 200===e.data&&alert("操作失败，请重试")},function(t){console.log("modify notice post failed"),console.log(t)})}else n()("#loginModal").modal("show")}),this.hasClicked=!1))},deleteSwitchOn:function(){n()("#delConfirmModal").modal({backdrop:"static"})},deleteSwitchOff:function(){this.hasClicked||n()("#delConfirmModal").modal("hide")},submitDeleteNotice:function(){var t=this;this.hasClicked||(this.hasClicked=!0,this.checkSession().then(function(e){if(e){var o={noticeId:t.modifyNotice.noticeId};t.axios.post(t.getAPI()+"/notice/delete",o).then(function(e){100===e.data?(n()("#delConfirmModal").modal("hide"),n()("#noticeModal").modal("hide"),t.modifyIndex.onboard?(t.currentRecords.splice(t.modifyIndex.index,1),t.currentRecordId.splice(t.modifyIndex.index,1)):(t.oldRecords.splice(t.modifyIndex.index,1),t.oldRecordId.splice(t.modifyIndex.index,1)),t.modifyNotice={},t.modifyIndex={},alert("删除成功")):200===e.data?alert("删除失败，请重试"):-999===e.data&&alert("服务器错误，请重试")},function(t){console.log("delete notice post failed"),console.log(t)})}else n()("#loginModal").modal("show")}),this.hasClicked=!1)},changeStatus:function(t,e){var o=this;this.checkSession().then(function(i){var a;i?(a=e?{noticeId:o.currentRecordId[t],status:0}:{noticeId:o.oldRecordId[t],status:1},o.axios.post(o.getAPI()+"/notice/change-status",a).then(function(i){100===i.data?e?(o.oldRecords.unshift(o.currentRecords[t]),o.oldRecordId.unshift(o.currentRecordId[t]),o.currentRecords.splice(t,1),o.currentRecordId.splice(t,1)):(o.currentRecords.unshift(o.oldRecords[t]),o.currentRecordId.unshift(o.oldRecordId[t]),o.oldRecords.splice(t,1),o.oldRecordId.splice(t,1)):200===i.data?alert("操作失败，请重试"):-999===i.data&&alert("服务器错误，请重试")},function(t){console.log("change status post failed"),console.log(t)})):n()("#loginModal").modal("show")})},dateTimeTrim:function(t){return this.$moment(t).format("YYYY-MM-DD HH:mm:ss")},checkFormat:function(t){return null===t.title||""===t.title||null===t.content||""===t.content},resetNewNotice:function(){this.newNotice.title="",this.newNotice.content=""}},beforeMount:function(){this.getNoticeList()}},d=l,r=(o("6573"),o("2877")),u=Object(r["a"])(d,i,a,!1,null,"1f9901f3",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-b854e180.b40f03df.js.map