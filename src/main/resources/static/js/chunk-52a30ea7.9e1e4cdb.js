(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-52a30ea7"],{"0dc3":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"info-table"}},[t._m(0),o("div",{attrs:{id:"function-bar"}},[o("div",{attrs:{id:"operation-bar"}},[o("button",{staticClass:"btn btn-success",on:{click:t.getAllHealthInfo}},[t._v("全部住户")])]),o("form",{staticClass:"form-inline my-2 my-lg-0",attrs:{id:"search-bar"},on:{submit:t.searchHealthReport}},[o("label",{staticStyle:{"padding-right":"15px"},attrs:{for:"search-input"}},[t._v("搜索住户:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"form-control mr-sm-2",attrs:{id:"search-input",type:"search",placeholder:"输入ID、姓名、床号","aria-label":"Search",required:""},domProps:{value:t.searchInput},on:{input:function(e){e.target.composing||(t.searchInput=e.target.value)}}}),o("button",{staticClass:"btn btn-success my-2 my-sm-0",attrs:{type:"submit"}},[t._v("搜索")])])]),o("table",{staticClass:"table table-hover table-responsive-lg",attrs:{id:"main-table"}},[t._m(1),o("tbody",t._l(t.healthReport,function(e,a){return o("tr",[o("th",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t._l(e,function(e){return o("td",[t._v("\n        "+t._s(e)+"\n      ")])}),o("td",[o("button",{staticClass:"btn btn-info btn-sm",on:{click:function(e){return t.getDetail(a)}}},[t._v("详情")]),o("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.addRecord(a)}}},[t._v("添加")])])],2)}),0)]),o("div",{staticClass:"modal fade",attrs:{id:"infoModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(2),o("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[t._v("\n          "+t._s(t.loadingStatus)+"\n        ")]),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[o("table",{staticClass:"table table-bordered"},[o("tbody",[o("tr",[o("th",{attrs:{scope:"row"}},[t._v("ID:")]),o("td",[t._v(t._s(t.residentDetail.id))]),o("th",{attrs:{scope:"row"}},[t._v("姓名")]),o("td",[t._v(t._s(t.residentDetail.name))]),o("th",{attrs:{scope:"row"}},[t._v("性别")]),o("td",[t._v(t._s(t.residentDetail.sex))]),o("th",{attrs:{scope:"row"}},[t._v("出生年月")]),o("td",[t._v(t._s(t.residentDetail.dob))]),o("th",{attrs:{scope:"row"}},[t._v("床号")]),o("td",[t._v(t._s(t.residentDetail.bed))])]),t._m(3),o("tr",[o("td",{staticClass:"medical-text",attrs:{colspan:"10"}},[t._v(t._s(t.residentDetail.medicalHistory))])]),t._m(4),o("tr",[-1===t.modifying?[o("td",{directives:[{name:"show",rawName:"v-show",value:!t.addingRecord,expression:"!addingRecord"}],staticClass:"medical-text",attrs:{colspan:"10"},domProps:{innerHTML:t._s(t.showSgn)}}),o("td",{directives:[{name:"show",rawName:"v-show",value:t.addingRecord,expression:"addingRecord"}],attrs:{colspan:"10"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.suggestion,expression:"newHealthRecord.suggestion"}],staticClass:"form-control",attrs:{type:"text",placeholder:"健康建议"},domProps:{value:t.newHealthRecord.suggestion},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"suggestion",e.target.value)}}})])]:t._e(),-1!==t.modifying?[o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[t.modifying],expression:"modifyFlag[modifying]"}],attrs:{colspan:"10"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.suggestion,expression:"modifyRecord.suggestion"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.suggestion},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"suggestion",e.target.value)}}})])]:t._e()],2)])]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-4"}),o("div",{staticClass:"col-4"},[t.operationSuccess?[o("b-alert",{attrs:{show:t.dismissCountDown,dismissible:"",fade:"",variant:"success"},on:{dismissed:function(e){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t._v("\n                  操作成功\n                ")])]:t._e(),t.operationSuccess?t._e():[o("b-alert",{attrs:{show:t.dismissCountDown,dismissible:"",fade:"",variant:"danger"},on:{dismissed:function(e){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t._v("\n                  操作失败，请稍后重试\n                ")])]],2),o("div",{staticClass:"col-4"})]),o("div",{staticClass:"row"},[o("div",{staticClass:"col-4"},[o("button",{staticClass:"btn btn-primary btn-sm",on:{click:t.addSwitchOn}},[t._v("添加记录")])]),o("div",{staticClass:"col-4"},[t._v(t._s(t.reportStatus))]),o("div",{staticClass:"col-4"})]),o("table",{staticClass:"table table-hover table-responsive-lg table-sm",attrs:{id:"history-record"}},[t._m(5),o("tbody",[o("tr",{directives:[{name:"show",rawName:"v-show",value:t.addingRecord,expression:"addingRecord"}]},[o("th",{attrs:{scope:"row"}},[t._v("新")]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.height,expression:"newHealthRecord.height"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.height},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"height",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.weight,expression:"newHealthRecord.weight"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.weight},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"weight",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.heartRate,expression:"newHealthRecord.heartRate"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.heartRate},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"heartRate",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.bpSystolic,expression:"newHealthRecord.bpSystolic"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.bpSystolic},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"bpSystolic",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.bpDiastolic,expression:"newHealthRecord.bpDiastolic"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.bpDiastolic},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"bpDiastolic",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.bloodGlucose,expression:"newHealthRecord.bloodGlucose"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.bloodGlucose},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"bloodGlucose",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.bloodLipids,expression:"newHealthRecord.bloodLipids"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.bloodLipids},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"bloodLipids",e.target.value)}}})]),o("td",[o("input",{directives:[{name:"model",rawName:"v-model",value:t.newHealthRecord.uricAcid,expression:"newHealthRecord.uricAcid"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newHealthRecord.uricAcid},on:{input:function(e){e.target.composing||t.$set(t.newHealthRecord,"uricAcid",e.target.value)}}})]),o("td",{staticClass:"status-info"},[t._v(t._s(t.uploadStatus))]),o("td",[o("button",{staticClass:"btn btn-primary btn-sm",class:{disabled:t.hasClicked},on:{click:t.submitNewRecord}},[t._v("提交")]),o("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},on:{click:t.addSwitchOff}},[t._v("取消")])])]),t._l(t.reportDetail,function(e,a){return o("tr",{attrs:{"data-toggle":"tooltip",title:"点击查看健康建议"},on:{click:function(e){return t.showSuggestion(a)}}},[o("th",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t._l(e,function(e){return o("td",{directives:[{name:"show",rawName:"v-show",value:!t.modifyFlag[a],expression:"!modifyFlag[index]"}]},[t._v("\n                "+t._s(e)+"\n              ")])}),o("td",{directives:[{name:"show",rawName:"v-show",value:!t.modifyFlag[a],expression:"!modifyFlag[index]"}]},[o("button",{staticClass:"btn btn-warning btn-sm",on:{click:function(e){return t.modifySwitchOn(a)}}},[t._v("修改")]),o("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(e){return t.deleteSwitchOn(a)}}},[t._v("删除")])]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.height,expression:"modifyRecord.height"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.height},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"height",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.weight,expression:"modifyRecord.weight"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.weight},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"weight",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.heartRate,expression:"modifyRecord.heartRate"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.heartRate},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"heartRate",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.bpSystolic,expression:"modifyRecord.bpSystolic"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.bpSystolic},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"bpSystolic",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.bpDiastolic,expression:"modifyRecord.bpDiastolic"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.bpDiastolic},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"bpDiastolic",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.bloodGlucose,expression:"modifyRecord.bloodGlucose"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.bloodGlucose},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"bloodGlucose",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.bloodLipids,expression:"modifyRecord.bloodLipids"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.bloodLipids},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"bloodLipids",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyRecord.uricAcid,expression:"modifyRecord.uricAcid"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyRecord.uricAcid},on:{input:function(e){e.target.composing||t.$set(t.modifyRecord,"uricAcid",e.target.value)}}})]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}],staticClass:"status-info"},[t._v(t._s(t.uploadStatus))]),o("td",{directives:[{name:"show",rawName:"v-show",value:t.modifyFlag[a],expression:"modifyFlag[index]"}]},[o("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.submitModRecord(a)}}},[t._v("提交")]),o("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(e){return t.modifySwitchOff(a)}}},[t._v("取消")])])],2)})],2)])]),t._m(6)])])]),o("div",{staticClass:"modal fade",attrs:{id:"loginModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-md",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(7),o("div",{staticClass:"modal-body",attrs:{id:"loginModalBody"}},[o("LoginModal")],1)])])]),o("div",{staticClass:"modal",attrs:{tabindex:"-1",role:"dialog",id:"delConfirmModal"}},[o("div",{staticClass:"modal-dialog modal-dialog-centered modal-sm",attrs:{role:"document"}},[o("div",{staticClass:"modal-content"},[t._m(8),o("div",{staticClass:"modal-body"},[o("p",[t._v("确认删除记录？该操作不可恢复")]),o("div",{staticClass:"status-info"},[t._v(t._s(t.uploadStatus))])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.submitDelRecord}},[t._v("确定")]),o("button",{staticClass:"btn btn-secondary",class:{disabled:t.hasClicked},attrs:{type:"button","data-dismiss":"modal"},on:{click:t.deleteSwitchOff}},[t._v("取消")])])])])])])},i=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"panel-title"}},[o("h5",[o("strong",[t._v("健康报告")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("#")]),o("th",{attrs:{scope:"col"}},[t._v("ID")]),o("th",{attrs:{scope:"col"}},[t._v("姓名")]),o("th",{attrs:{scope:"col"}},[t._v("性别")]),o("th",{attrs:{scope:"col"}},[t._v("出生年月")]),o("th",{attrs:{scope:"col"}},[t._v("床号")]),o("th",{attrs:{scope:"col"}},[t._v("最新记录时间")]),o("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title",attrs:{id:"infoModalLabel"}},[t._v("健康报告记录")]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("tr",[o("th",{attrs:{scope:"row",colspan:"10"}},[t._v("既往病史")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("tr",[o("th",{attrs:{scope:"row",colspan:"10"}},[t._v("健康建议")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th",{attrs:{scope:"col"}},[t._v("#")]),o("th",{attrs:{scope:"col"}},[t._v("身高(cm)")]),o("th",{attrs:{scope:"col"}},[t._v("体重(kg)")]),o("th",{attrs:{scope:"col"}},[t._v("心率(次/min)")]),o("th",{attrs:{scope:"col"}},[t._v("血压(收缩压)(mmHg)")]),o("th",{attrs:{scope:"col"}},[t._v("血压(舒张压)(mmHg)")]),o("th",{attrs:{scope:"col"}},[t._v("血糖(mmol/L)")]),o("th",{attrs:{scope:"col"}},[t._v("总胆固醇(mmol/L)")]),o("th",{attrs:{scope:"col"}},[t._v("尿酸(μmol/L)")]),o("th",{attrs:{scope:"col"}},[t._v("时间")]),o("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("关闭")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title",attrs:{id:"loginModalLabel"}},[t._v("会话超时")]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"modal-header"},[o("h5",{staticClass:"modal-title"},[t._v("删除确认")]),o("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[o("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],s=(o("6b54"),o("7f7f"),o("1157")),d=o.n(s),r=o("4ed9"),n={name:"healthReport",components:{LoginModal:r["a"]},data:function(){return{healthReport:[],reportDetail:[],reportId:[],reportSuggestion:[],showSgn:"",reportStatus:"",newHealthRecord:{height:"",weight:"",heartRate:"",bpSystolic:"",bpDiastolic:"",bloodGlucose:"",bloodLipids:"",uricAcid:"",suggestion:""},addingRecord:!1,modifyFlag:[],modifying:-1,modifyRecord:{height:"",weight:"",heartRate:"",bpSystolic:"",bpDiastolic:"",bloodGlucose:"",bloodLipids:"",uricAcid:"",suggestion:""},deleting:-1,recordFormat:{},residentDetail:{},loading:!0,loadingStatus:"加载中...",uploadStatus:"",hasClicked:!1,searchInput:"",operationSuccess:!1,dismissSecs:3,dismissCountDown:0,showDismissibleAlert:!1}},computed:{isOnline:function(){return this.$store.getters.getOnline}},watch:{isOnline:function(){this.$store.getters.getOnline&&(d()("#loginModal").modal("hide"),this.getAllHealthInfo())}},methods:{getAllHealthInfo:function(){var t=this;this.checkSession().then(function(e){e?t.axios.get(t.getAPI()+"/health/base-info").then(function(e){t.healthReport=[];for(var o=0;o<e.data.length;o++){var a={id:e.data[o].resId,name:e.data[o].name,sex:t.sexCheck(e.data[o].sex),dob:t.dateTrim(e.data[o].dob),bed:e.data[o].numOfBed,recordDate:t.dateTimeTrim(e.data[o].recordDate)};"Invalid date"===a.recordDate&&(a.recordDate="暂无检查记录"),t.healthReport.push(a)}},function(t){console.log("Get Failed"),console.log(t.data)}):d()("#loginModal").modal("show")})},getDetail:function(t){var e=this;this.addSwitchOff(),this.showSgn="点击下方记录查看建议",this.checkSession().then(function(o){if(o){d()("#infoModal").modal("show");var a={resId:e.healthReport[t].id};e.axios.post(e.getAPI()+"/health/detail",a,{timeout:15e3}).then(function(t){e.reportDetail=[],e.modifyFlag=[],e.reportSuggestion=[],e.reportId=[],e.residentDetail={id:t.data[0].resId,name:t.data[0].name,sex:e.sexCheck(t.data[0].sex),dob:e.dateTrim(t.data[0].dob),bed:t.data[0].numOfBed,medicalHistory:t.data[0].medicalHistory};for(var o=0;o<t.data.length;o++){if(null===t.data[o].recordDate){e.reportStatus="暂无检查记录";break}e.reportStatus="";var a={height:t.data[o].height,weight:t.data[o].weight,heartRate:t.data[o].heartRate,bpSystolic:t.data[o].bpSystolic,bpDiastolic:t.data[o].bpDiastolic,bloodGlucose:t.data[o].bloodGlucose,bloodLipids:t.data[o].bloodLipids,uricAcid:t.data[o].uricAcid,recordDate:e.dateTimeTrim(t.data[o].recordDate)};e.modifyFlag.push(!1),e.modifying=-1,e.reportDetail.push(a),e.reportSuggestion.push(t.data[o].suggestion),e.reportId.push(t.data[o].reportId)}e.loadingStatus="加载完成",e.loading=!1},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?e.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(t))})}else d()("#loginModal").modal("show")})},showSuggestion:function(t){this.showSgn=this.reportSuggestion[t]+"<br>报告时间："+this.reportDetail[t].recordDate},addRecord:function(t){this.getDetail(t),this.addSwitchOn()},addSwitchOn:function(){this.addingRecord=!0,-1!==this.modifying&&this.modifySwitchOff(this.modifying),this.uploadStatus=""},addSwitchOff:function(){this.hasClicked||(this.addingRecord=!1,this.newHealthRecord={})},modifySwitchOn:function(t){this.addingRecord?(this.addSwitchOff(),this.modifying=t,this.$set(this.modifyFlag,t,!this.modifyFlag[t])):-1===this.modifying?(this.modifying=t,this.$set(this.modifyFlag,t,!this.modifyFlag[t])):(this.$set(this.modifyFlag,this.modifying,!this.modifyFlag[this.modifying]),this.modifying=t,this.$set(this.modifyFlag,t,!this.modifyFlag[t])),this.modifyRecord.height=this.reportDetail[t].height,this.modifyRecord.weight=this.reportDetail[t].weight,this.modifyRecord.heartRate=this.reportDetail[t].heartRate,this.modifyRecord.bpSystolic=this.reportDetail[t].bpSystolic,this.modifyRecord.bpDiastolic=this.reportDetail[t].bpDiastolic,this.modifyRecord.bloodGlucose=this.reportDetail[t].bloodGlucose,this.modifyRecord.bloodLipids=this.reportDetail[t].bloodLipids,this.modifyRecord.uricAcid=this.reportDetail[t].uricAcid,this.modifyRecord.suggestion=this.reportSuggestion[t],this.uploadStatus=""},modifySwitchOff:function(t){this.$set(this.modifyFlag,t,!this.modifyFlag[t]),this.modifying=-1,this.modifyRecord={}},deleteSwitchOn:function(t){d()("#delConfirmModal").modal({backdrop:"static"}),this.deleting=t,this.uploadStatus=""},deleteSwitchOff:function(){this.deleting=-1,d()("#delConfirmModal").modal("hide")},submitNewRecord:function(){var t=this;this.hasClicked||this.checkFormat(this.newHealthRecord)&&(this.hasClicked=!0,this.checkSession().then(function(e){if(e){var o={resId:t.residentDetail.id,height:t.newHealthRecord.height,weight:t.newHealthRecord.weight,heartRate:t.newHealthRecord.heartRate,bpSystolic:t.newHealthRecord.bpSystolic,bpDiastolic:t.newHealthRecord.bpDiastolic,bloodGlucose:t.newHealthRecord.bloodGlucose,bloodLipids:t.newHealthRecord.bloodLipids,uricAcid:t.newHealthRecord.uricAcid,suggestion:t.newHealthRecord.suggestion};t.uploadStatus="正在上传记录...",t.axios.post(t.getAPI()+"/health/add-record",o).then(function(e){if(100===e.data){t.uploadStatus="添加成功",t.newHealthRecord={},t.addingRecord=!1,t.hasClicked=!1;var o={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/health/detail",o,{timeout:15e3}).then(function(e){t.reportDetail=[],t.modifyFlag=[],t.reportSuggestion=[],t.reportId=[];for(var o=0;o<e.data.length;o++){if(null===e.data[o].recordDate){t.reportStatus="暂无检查记录";break}t.reportStatus="";var a={height:e.data[o].height,weight:e.data[o].weight,heartRate:e.data[o].heartRate,bpSystolic:e.data[o].bpSystolic,bpDiastolic:e.data[o].bpDiastolic,bloodGlucose:e.data[o].bloodGlucose,bloodLipids:e.data[o].bloodLipids,uricAcid:e.data[o].uricAcid,recordDate:t.dateTimeTrim(e.data[o].recordDate)};t.modifyFlag.push(!1),t.modifying=-1,t.reportDetail.push(a),t.reportSuggestion.push(e.data[o].suggestion),t.reportId.push(e.data[o].reportId),t.uploadStatus=""}},function(e){"ECONNABORTED"===e.code&&-1!==e.toString().indexOf("timeout")?t.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(e))})}else 200===e.data?(t.uploadStatus="添加失败请重试",t.hasClicked=!1):-999===e.data&&(t.uploadStatus="服务器错误，请稍后尝试",t.hasClicked=!1)},function(t){console.log("post info failed"),console.log(t.data)})}else t.hasClicked=!1,d()("#loginModal").modal("show")}))},submitModRecord:function(t){var e=this;this.hasClicked||this.checkFormat(this.modifyRecord)&&(this.hasClicked=!0,this.checkSession().then(function(o){if(o){var a={resId:e.residentDetail.id,height:e.modifyRecord.height,weight:e.modifyRecord.weight,heartRate:e.modifyRecord.heartRate,bpSystolic:e.modifyRecord.bpSystolic,bpDiastolic:e.modifyRecord.bpDiastolic,bloodGlucose:e.modifyRecord.bloodGlucose,bloodLipids:e.modifyRecord.bloodLipids,uricAcid:e.modifyRecord.uricAcid,suggestion:e.modifyRecord.suggestion,reportId:e.reportId[t]};e.uploadStatus="正在上传记录...",e.axios.post(e.getAPI()+"/health/modify-record",a).then(function(t){if(100===t.data){e.uploadStatus="修改成功",e.modifyRecord={},e.showAlert(!0);var o={resId:e.residentDetail.id};e.axios.post(e.getAPI()+"/health/detail",o,{timeout:15e3}).then(function(t){e.reportDetail=[],e.modifyFlag=[],e.reportSuggestion=[],e.reportId=[];for(var o=0;o<t.data.length;o++){if(null===t.data[o].recordDate){e.reportStatus="暂无检查记录";break}e.reportStatus="";var a={height:t.data[o].height,weight:t.data[o].weight,heartRate:t.data[o].heartRate,bpSystolic:t.data[o].bpSystolic,bpDiastolic:t.data[o].bpDiastolic,bloodGlucose:t.data[o].bloodGlucose,bloodLipids:t.data[o].bloodLipids,uricAcid:t.data[o].uricAcid,recordDate:e.dateTimeTrim(t.data[o].recordDate)};e.modifyFlag.push(!1),e.reportDetail.push(a),e.reportSuggestion.push(t.data[o].suggestion),e.reportId.push(t.data[o].reportId)}e.modifying=-1},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?e.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(t))})}else 200===t.data?(e.uploadStatus="修改失败请重试",e.showAlert(!1)):-999===t.data&&(e.uploadStatus="服务器错误，请稍后尝试",e.showAlert(!1))},function(t){e.uploadStatus="网络错误",e.showAlert(!1),console.log("post info failed"),console.log(t)})}else d()("#loginModal").modal("show")}),this.hasClicked=!1)},submitDelRecord:function(){var t=this;this.hasClicked||(this.hasClicked=!0,this.uploadStatus="正在删除",this.checkSession().then(function(e){if(e){var o={resId:t.residentDetail.id,reportId:t.reportId[t.deleting]};t.axios.post(t.getAPI()+"/health/delete-record",o,{timeout:15e3}).then(function(e){if(100===e.data){t.uploadStatus="删除成功",t.deleting=-1,t.showAlert(!0),d()("#delConfirmModal").modal("hide");var o={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/health/detail",o,{timeout:15e3}).then(function(e){t.reportDetail=[],t.reportSuggestion=[],t.reportId=[],t.modifyFlag=[];for(var o=0;o<e.data.length;o++){if(null===e.data[o].recordDate){t.reportStatus="暂无检查记录";break}t.reportStatus="";var a={height:e.data[o].height,weight:e.data[o].weight,heartRate:e.data[o].heartRate,bpSystolic:e.data[o].bpSystolic,bpDiastolic:e.data[o].bpDiastolic,bloodGlucose:e.data[o].bloodGlucose,bloodLipids:e.data[o].bloodLipids,uricAcid:e.data[o].uricAcid,recordDate:t.dateTimeTrim(e.data[o].recordDate)};t.modifyFlag.push(!1),t.reportDetail.push(a),t.reportSuggestion.push(e.data[o].suggestion),t.reportId.push(e.data[o].reportId)}},function(e){"ECONNABORTED"===e.code&&-1!==e.toString().indexOf("timeout")?t.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(e))})}},function(e){"ECONNABORTED"===e.code&&-1!==e.toString().indexOf("timeout")?t.uploadStatus="加载超时，请重试":(console.log("post failed"),console.log(e)),d()("#delConfirmModal").modal("hide"),t.showAlert(!1)}),t.hasClicked=!1}else d()("#loginModal").modal("show")}))},searchHealthReport:function(t){var e=this;t.preventDefault(),this.checkSession().then(function(t){if(t){var o={search:e.searchInput};e.axios.post(e.getAPI()+"/health/search",o).then(function(t){e.healthReport=[];for(var o=0;o<t.data.length;o++){var a={id:t.data[o].resId,name:t.data[o].name,sex:e.sexCheck(t.data[o].sex),dob:e.dateTrim(t.data[o].dob),bed:t.data[o].numOfBed,recordDate:e.dateTimeTrim(t.data[o].recordDate)};"Invalid date"===a.recordDate&&(a.recordDate="暂无检查记录"),e.healthReport.push(a)}},function(t){console.log("search post failed"),console.log(t.data)})}else d()("#loginModal").modal("show")})},checkFormat:function(t){if(null==t.height||null==t.weight||null==t.heartRate||null==t.bpSystolic||null==t.bpDiastolic||null==t.bloodGlucose||null==t.bloodLipids||null==t.uricAcid||null==t.suggestion)return alert("请将记录填写完整"),!1;var e=/^[0-9]+$/,o=/^[0-9]+(\.[0-9]{1,2})?$/;return!!(e.test(t.heartRate)&&e.test(t.bpSystolic)&&e.test(t.bpDiastolic)&&o.test(t.height)&&o.test(t.weight)&&o.test(t.bloodGlucose)&&o.test(t.bloodLipids)&&o.test(t.uricAcid)&&t.suggestion.length<100)||(alert("记录格式不正确"),!1)},sexCheck:function(t){return"MALE"===t?"男":"FEMALE"===t?"女":"N/A"},dateTrim:function(t){return this.$moment(t).format("YYYY-MM-DD")},dateTimeTrim:function(t){return this.$moment(t).format("YYYY-MM-DD HH:mm:ss")},countDownChanged:function(t){this.dismissCountDown=t},showAlert:function(t){this.operationSuccess=t,this.dismissCountDown=this.dismissSecs}},beforeMount:function(){this.getAllHealthInfo()}},l=n,c=(o("d4cc"),o("2877")),u=Object(c["a"])(l,a,i,!1,null,"20d899f2",null);e["default"]=u.exports},"27b8":function(t,e,o){"use strict";var a=o("8eec"),i=o.n(a);i.a},"4e60":function(t,e,o){},"4ed9":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{attrs:{id:"loginFrame"}},[t._m(0),o("div",{attrs:{id:"login"}},[t.show?o("b-form",{on:{submit:t.onSubmit,reset:t.onReset}},[o("b-form-group",{attrs:{id:"userId",label:"ID:","label-for":"userIdInput"}},[o("b-form-input",{attrs:{id:"userIdInput",type:"text",required:"",placeholder:"输入ID"},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),o("b-form-group",{attrs:{id:"password",label:"密码:","label-for":"passwordInput"}},[o("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),o("div",{attrs:{id:"loginStatus"}},[o("span",[t._v(t._s(t.loginStatus))])]),o("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"submit",variant:"primary",size:"md"}},[t._v("登陆\n        ")]),o("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"reset",variant:"danger",size:"md"}},[t._v("重置\n        ")])],1):t._e()],1)])])},i=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"title"}},[o("h3",[t._v("用户登录")])])}],s=o("f499"),d=o.n(s),r=(o("6b54"),o("96cf"),o("3b8d")),n=o("c0d6"),l={data:function(){return{form:{userId:"",password:""},loginStatus:"",show:!0,hasClicked:!1}},methods:{onSubmit:function(t){var e=this;if(t.preventDefault(),!this.hasClicked){var o=/[0-9]+/;o.test(this.form.userId)?(this.hasClicked=!0,this.loginStatus="登陆中...",this.login().then(function(t){100===t?(e.loginStatus="登陆成功",e.fetchData(),e.form.userId="",e.form.password="",e.loginStatus="",e.hasClicked=!1):500===t?(e.loginStatus="账户尚未激活",e.hasClicked=!1,e.$router.push({name:"activate"})):210===t?(e.loginStatus="请求超时，请重试",e.hasClicked=!1):-999===t?(e.loginStatus="服务器开小差了，请重试",e.hasClicked=!1):(e.loginStatus="ID或密码不正确",e.hasClicked=!1)})):this.loginStatus="ID必须为数字"}},onReset:function(t){var e=this;t.preventDefault(),this.hasClicked||(this.form.userId="",this.form.password="",this.loginStatus="",this.show=!1,this.$nextTick(function(){e.show=!0}))},login:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={userId:this.form.userId,password:this.form.password},o=200,t.next=4,this.axios.post(this.getAPI()+"/login",e,{timeout:15e3}).then(function(t){console.log(t.data),o=t.data},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?o=210:(console.log("post failed"),console.log(t))});case 4:return t.abrupt("return",o);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),fetchData:function(){this.axios.get(this.getAPI()+"/user").then(function(t){localStorage.setItem("user",d()(t.data)),n["a"].commit("setUser")},function(t){console.log("post failed"),console.log(t)})}}},c=l,u=(o("27b8"),o("2877")),h=Object(u["a"])(c,a,i,!1,null,"f1f5a078",null);e["a"]=h.exports},"7f7f":function(t,e,o){var a=o("86cc").f,i=Function.prototype,s=/^\s*function ([^ (]*)/,d="name";d in i||o("9e1e")&&a(i,d,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"8eec":function(t,e,o){},d4cc:function(t,e,o){"use strict";var a=o("4e60"),i=o.n(a);i.a}}]);
//# sourceMappingURL=chunk-52a30ea7.9e1e4cdb.js.map