(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20716fea"],{"4e0f":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"info-table"}},[t._m(0),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{attrs:{id:"operation-bar"}},[e("button",{staticClass:"btn btn-success",on:{click:t.getAllBillInfo}},[t._v("全部住户")])])]),e("div",{staticClass:"col-6"},[e("form",{staticClass:"form-inline my-2 my-lg-0",attrs:{id:"search-bar"},on:{submit:t.searchBill}},[e("label",{staticStyle:{"padding-right":"15px"},attrs:{for:"search-input"}},[t._v("搜索住户:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"form-control mr-sm-2",attrs:{id:"search-input",type:"search",placeholder:"输入ID、姓名、床号","aria-label":"Search",required:""},domProps:{value:t.searchInput},on:{input:function(i){i.target.composing||(t.searchInput=i.target.value)}}}),e("button",{staticClass:"btn btn-success my-2 my-sm-0",attrs:{type:"submit"}},[t._v("搜索")])])])]),e("table",{staticClass:"table table-hover table-responsive-lg",attrs:{id:"main-table"}},[t._m(1),e("tbody",t._l(t.billList,function(i,a){return e("tr",[e("th",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t._l(i,function(i){return e("td",[t._v("\n        "+t._s(i)+"\n      ")])}),e("td",[e("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(i){return t.addBillRecord(a)}}},[t._v("添加账单")]),e("button",{staticClass:"btn btn-warning btn-sm",on:{click:function(i){return t.addPaymentRecord(a)}}},[t._v("支付")]),e("button",{staticClass:"btn btn-info btn-sm",on:{click:function(i){return t.getDetail(a)}}},[t._v("详情")])])],2)}),0)]),e("div",{staticClass:"modal fade",attrs:{id:"infoModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered modal-dialog-scrollable  modal-xl",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(2),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[t._v("\n          "+t._s(t.loadingStatus)+"\n        ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[e("table",{staticClass:"table table-bordered"},[e("tbody",[e("tr",[e("th",{attrs:{scope:"row"}},[t._v("ID:")]),e("td",[t._v(t._s(t.residentDetail.id))]),e("th",{attrs:{scope:"row"}},[t._v("姓名")]),e("td",[t._v(t._s(t.residentDetail.name))]),e("th",{attrs:{scope:"row"}},[t._v("床号")]),e("td",[t._v(t._s(t.residentDetail.bed))])]),e("tr",[e("th",[t._v("欠款")]),e("td",[t._v(t._s(t.billNPayment.totalBill))]),e("th",[t._v("已付")]),e("td",[t._v(t._s(t.billNPayment.totalPaid))]),e("th",[t._v("结余")]),e("td",[t._v(t._s(t.billNPayment.totalPaid-t.billNPayment.totalBill))])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-4"},[e("button",{staticClass:"btn btn-success btn-sm",on:{click:function(i){return t.getDetail(t.currentResident)}}},[t._v("全部记录")]),e("button",{staticClass:"btn btn-primary btn-sm",on:{click:t.addBillSwitchOn}},[t._v("添加账单")]),e("button",{staticClass:"btn btn-warning btn-sm",on:{click:t.addPaymentSwitchOn}},[t._v("支付账单")])]),e("div",{staticClass:"col-6"}),e("div",{staticClass:"col-2"},[t._v(t._s(t.recordLoadingStatus))])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-4"}),e("div",{staticClass:"col-4"},[t.operationSuccess?[e("b-alert",{attrs:{show:t.dismissCountDown,dismissible:"",fade:"",variant:"success"},on:{dismissed:function(i){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t._v("\n                  操作成功\n                ")])]:t._e(),t.operationSuccess?t._e():[e("b-alert",{attrs:{show:t.dismissCountDown,dismissible:"",fade:"",variant:"danger"},on:{dismissed:function(i){t.dismissCountDown=0},"dismiss-count-down":t.countDownChanged}},[t._v("\n                  操作失败，请稍后重试\n                ")])]],2),e("div",{staticClass:"col-4"})]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("table",{staticClass:"table table-hover table-responsive-lg table-sm history-record"},[t._m(3),e("tbody",[e("tr",{directives:[{name:"show",rawName:"v-show",value:t.addingBillRecord,expression:"addingBillRecord"}]},[e("th",{attrs:{scope:"row"}},[t._v("新")]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newBillRecord.item,expression:"newBillRecord.item"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newBillRecord.item},on:{input:function(i){i.target.composing||t.$set(t.newBillRecord,"item",i.target.value)}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newBillRecord.amount,expression:"newBillRecord.amount"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newBillRecord.amount},on:{input:function(i){i.target.composing||t.$set(t.newBillRecord,"amount",i.target.value)}}})]),e("td",{staticClass:"status-info"},[t._v(t._s(t.connectStatus))]),e("td",[e("button",{staticClass:"btn btn-primary btn-sm",class:{disabled:t.hasClicked},on:{click:t.submitNewBillRecord}},[t._v("提交\n                    ")]),e("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},on:{click:t.addBillSwitchOff}},[t._v("取消\n                    ")])])]),t._l(t.billDetail,function(i,a){return e("tr",[e("th",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t.billModifyFlag[a]?t._e():[t._l(i,function(i){return e("td",[t._v("\n                      "+t._s(i)+"\n                    ")])}),e("td",[e("button",{staticClass:"btn btn-warning btn-sm",on:{click:function(i){return t.billModifySwitchOn(a)}}},[t._v("修改")]),e("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(i){return t.billDeleteSwitchOn(a)}}},[t._v("删除")])])],t.billModifyFlag[a]?[e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyBillRecord.item,expression:"modifyBillRecord.item"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyBillRecord.item},on:{input:function(i){i.target.composing||t.$set(t.modifyBillRecord,"item",i.target.value)}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyBillRecord.amount,expression:"modifyBillRecord.amount"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyBillRecord.amount},on:{input:function(i){i.target.composing||t.$set(t.modifyBillRecord,"amount",i.target.value)}}})]),e("td",{staticClass:"status-info"},[t._v(t._s(t.connectStatus))]),e("td",[e("button",{staticClass:"btn btn-primary btn-sm",class:{disabled:t.hasClicked},on:{click:function(i){t.submitModBillRecord(a)}}},[t._v("提交")]),e("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},on:{click:function(i){return t.billModifySwitchOff(a)}}},[t._v("取消")])])]:t._e()],2)})],2)])]),e("div",{staticClass:"col-6"},[e("table",{staticClass:"table table-hover table-responsive-lg table-sm history-record"},[t._m(4),e("tbody",[e("tr",{directives:[{name:"show",rawName:"v-show",value:t.addingPaymentRecord,expression:"addingPaymentRecord"}]},[e("th",{attrs:{scope:"row"}},[t._v("新")]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newPaymentRecord.paid,expression:"newPaymentRecord.paid"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.newPaymentRecord.paid},on:{input:function(i){i.target.composing||t.$set(t.newPaymentRecord,"paid",i.target.value)}}})]),e("td",{staticClass:"status-info",attrs:{colspan:"2"}},[t._v(t._s(t.connectStatus))]),e("td",[e("button",{staticClass:"btn btn-primary btn-sm",class:{disabled:t.hasClicked},on:{click:t.submitNewPaymentRecord}},[t._v("提交\n                    ")]),e("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},on:{click:t.addPaymentSwitchOff}},[t._v("取消\n                    ")])])]),t._l(t.paymentDetail,function(i,a){return e("tr",[e("th",{attrs:{scope:"row"}},[t._v(t._s(a+1))]),t.paymentModifyFlag[a]?t._e():[t._l(i,function(i){return e("td",[t._v("\n                      "+t._s(i)+"\n                    ")])}),e("td",[e("button",{staticClass:"btn btn-warning btn-sm",on:{click:function(i){return t.paymentModifySwitchOn(a)}}},[t._v("修改")]),e("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(i){return t.paymentDeleteSwitchOn(a)}}},[t._v("删除")])])],t.paymentModifyFlag[a]?[e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modifyPaymentRecord.paid,expression:"modifyPaymentRecord.paid"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.modifyPaymentRecord.paid},on:{input:function(i){i.target.composing||t.$set(t.modifyPaymentRecord,"paid",i.target.value)}}})]),e("td",{staticClass:"status-info",attrs:{colspan:"2"}},[t._v(t._s(t.connectStatus))]),e("td",[e("button",{staticClass:"btn btn-primary btn-sm",class:{disabled:t.hasClicked},on:{click:function(i){t.submitModPaymentRecord(a)}}},[t._v("提交")]),e("button",{staticClass:"btn btn-danger btn-sm",class:{disabled:t.hasClicked},on:{click:function(i){return t.paymentModifySwitchOff(a)}}},[t._v("取消")])])]:t._e()],2)})],2)])])])]),t._m(5)])])]),e("div",{staticClass:"modal fade",attrs:{id:"loginModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered modal-md",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(6),e("div",{staticClass:"modal-body",attrs:{id:"loginModalBody"}},[e("LoginModal")],1)])])]),e("div",{staticClass:"modal",attrs:{tabindex:"-1",role:"dialog",id:"delConfirmModal"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered modal-sm",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(7),e("div",{staticClass:"modal-body"},[e("p",[t._v("确认删除记录？该操作不可恢复")]),e("div",{staticClass:"status-info"},[t._v(t._s(t.connectStatus))])]),e("div",{staticClass:"modal-footer"},[t.billDeleting>-1?[e("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:function(i){return t.submitDelBillRecord()}}},[t._v("确定")]),e("button",{staticClass:"btn btn-secondary",class:{disabled:t.hasClicked},attrs:{type:"button","data-dismiss":"modal"},on:{click:function(i){return t.billDeleteSwitchOff()}}},[t._v("取消")])]:t._e(),t.paymentDeleting>-1?[e("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:function(i){return t.submitDelPaymentRecord()}}},[t._v("确定")]),e("button",{staticClass:"btn btn-secondary",class:{disabled:t.hasClicked},attrs:{type:"button","data-dismiss":"modal"},on:{click:function(i){return t.paymentDeleteSwitchOff()}}},[t._v("取消")])]:t._e()],2)])])])])},o=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"panel-title"}},[e("h5",[e("strong",[t._v("个人账单")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),e("th",{attrs:{scope:"col"}},[t._v("ID")]),e("th",{attrs:{scope:"col"}},[t._v("姓名")]),e("th",{attrs:{scope:"col"}},[t._v("床号")]),e("th",{attrs:{scope:"col"}},[t._v("欠费")]),e("th",{attrs:{scope:"col"}},[t._v("已付")]),e("th",{attrs:{scope:"col"}},[t._v("结余")]),e("th",{attrs:{scope:"col"}},[t._v("最近账单日期")]),e("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"infoModalLabel"}},[t._v("账单详情")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),e("th",{attrs:{scope:"col"}},[t._v("消费内容")]),e("th",{attrs:{scope:"col"}},[t._v("消费金额")]),e("th",{attrs:{scope:"col"}},[t._v("记账时间")]),e("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),e("th",{attrs:{scope:"col"}},[t._v("支付金额")]),e("th",{attrs:{scope:"col"}},[t._v("支付平台")]),e("th",{attrs:{scope:"col"}},[t._v("记账时间")]),e("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("关闭")])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"loginModalLabel"}},[t._v("会话超时")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("删除确认")]),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],n=e("e814"),l=e.n(n),s=(e("6b54"),e("7f7f"),e("1157")),d=e.n(s),c=e("4ed9"),r=(e("ac5c"),e("ee9b")),m={name:"bill",components:{LoginModal:c["a"]},data:function(){return{currentResident:-1,billList:[],billNPayment:{totalBill:0,totalPaid:0},billDetail:[],billId:[],paymentDetail:[],paymentId:[],recordLoadingStatus:"",newBillRecord:{item:"",amount:0},addingBillRecord:!1,newPaymentRecord:{paid:0},addingPaymentRecord:!1,billModifyFlag:[],paymentModifyFlag:[],modifying:-1,modifyBillRecord:{item:"",amount:""},modifyPaymentRecord:{paid:""},billDeleting:-1,paymentDeleting:-1,billRecordFormat:{item:!1,amount:!1},paymentRecordFormat:{paid:!1},residentDetail:{},loading:!0,loadingStatus:"加载中...",connectStatus:"",hasClicked:!1,searchInput:"",language:r,operationSuccess:!1,dismissSecs:3,dismissCountDown:0,showDismissibleAlert:!1}},computed:{isOnline:function(){return this.$store.getters.getOnline}},watch:{isOnline:function(){this.$store.getters.getOnline&&(d()("#loginModal").modal("hide"),this.getAllBillInfo())}},methods:{getAllBillInfo:function(){var t=this;this.checkSession().then(function(i){i?t.axios.get(t.getAPI()+"/bill/bill-list").then(function(i){t.billList=[];for(var e=0;e<i.data.length;e++){var a={id:i.data[e].resId,name:i.data[e].name,bed:i.data[e].numOfBed,totalBill:i.data[e].totalBill,totalPaid:i.data[e].totalPaid,balance:i.data[e].totalPaid-i.data[e].totalBill,latestBillDate:t.dateTimeTrim(i.data[e].latestBillDate)};"Invalid date"===a.latestBillDate&&(a.latestBillDate="暂无记录"),t.billList.push(a)}},function(t){console.log("Get Failed"),console.log(t)}):d()("#loginModal").modal("show")})},getDetail:function(t){var i=this;this.addBillSwitchOff(),this.addPaymentSwitchOff(),this.recordLoadingStatus="",this.currentResident=t,this.checkSession().then(function(e){if(e){d()("#infoModal").modal("show");var a={resId:i.billList[t].id};i.axios.post(i.getAPI()+"/bill/detail",a,{timeout:15e3}).then(function(e){i.billDetail=[],i.billModifyFlag=[],i.billId=[],i.residentDetail={id:e.data[0].resId,name:e.data[0].name,bed:e.data[0].numOfBed};for(var a=0;a<e.data.length;a++){if(null===e.data[a].recordDate){i.recordLoadingStatus="暂无记录";break}var o={item:e.data[a].item,amount:e.data[a].amount,recordDate:i.dateTimeTrim(e.data[a].recordDate)};i.billModifyFlag.push(!1),i.modifying=-1,i.billDetail.push(o),i.billId.push(e.data[a].billId)}i.loadingStatus="加载完成",i.loading=!1,i.billNPayment.totalBill=i.billList[t].totalBill,i.billNPayment.totalPaid=i.billList[t].totalPaid},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?i.loadingStatus="加载超时，请重试":(console.log("post bill failed"),console.log(t))}),i.axios.post(i.getAPI()+"/payment/detail",a,{timeout:15e3}).then(function(t){i.paymentDetail=[],i.paymentModifyFlag=[],i.paymentId=[];for(var e=0;e<t.data.length;e++){if(null==t.data[e].recordDate){i.recordLoadingStatus="暂无记录";break}var a={paid:t.data[e].paid,platform:i.paymentPlatform(t.data[e].platform),recordDate:i.dateTimeTrim(t.data[e].recordDate)};i.paymentModifyFlag.push(!1),i.paymentDetail.push(a),i.paymentId.push(t.data[e].paymentId)}},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?i.loadingStatus="加载超时，请重试":(console.log("post payment failed"),console.log(t))}),i.currentResident=t}else d()("#loginModal").modal("show")})},addBillRecord:function(t){this.getDetail(t),this.addBillSwitchOn()},addBillSwitchOn:function(){this.addingBillRecord=!0,-1!==this.modifying&&(this.billModifyFlag[this.modifying]&&this.billModifySwitchOff(this.modifying),this.paymentModifyFlag[this.modifying]&&this.paymentModifySwitchOff(this.modifying)),this.addingPaymentRecord&&this.addPaymentSwitchOff(),this.connectStatus=""},addBillSwitchOff:function(){this.hasClicked||(this.addingBillRecord=!1,this.newBillRecord={},this.connectStatus="")},addPaymentRecord:function(t){this.getDetail(t),this.addPaymentSwitchOn()},addPaymentSwitchOn:function(){this.addingPaymentRecord=!0,-1!==this.modifying&&(this.billModifyFlag[this.modifying]&&this.billModifySwitchOff(this.modifying),this.paymentModifyFlag[this.modifying]&&this.paymentModifySwitchOff(this.modifying)),this.addingBillRecord&&this.addBillSwitchOff(),this.connectStatus=""},addPaymentSwitchOff:function(){this.hasClicked||(this.addingPaymentRecord=!1,this.newPaymentRecord={},this.connectStatus="")},billModifySwitchOn:function(t){this.addingBillRecord?(this.addBillSwitchOff(),this.modifying=t,this.$set(this.billModifyFlag,t,!this.billModifyFlag[t])):this.addingPaymentRecord?(this.addPaymentSwitchOff(),this.modifying=t,this.$set(this.billModifyFlag,t,!this.billModifyFlag[t])):-1===this.modifying?(this.modifying=t,this.$set(this.billModifyFlag,t,!this.billModifyFlag[t])):(this.billModifyFlag[this.modifying]&&this.billModifySwitchOff(this.modifying),this.paymentModifyFlag[this.modifying]&&this.paymentModifySwitchOff(this.modifying),this.modifying=t,this.$set(this.billModifyFlag,t,!this.billModifyFlag[t])),this.modifyBillRecord.item=this.billDetail[t].item,this.modifyBillRecord.amount=this.billDetail[t].amount,this.connectStatus=""},billModifySwitchOff:function(t){this.$set(this.billModifyFlag,t,!this.billModifyFlag[t]),this.modifying=-1,this.modifyBillRecord={}},paymentModifySwitchOn:function(t){this.addingBillRecord?(this.addBillSwitchOff(),this.modifying=t,this.$set(this.paymentModifyFlag,t,!this.paymentModifyFlag[t])):this.addingPaymentRecord?(this.addPaymentSwitchOff(),this.modifying=t,this.$set(this.paymentModifyFlag,t,!this.paymentModifyFlag[t])):-1===this.modifying?(this.modifying=t,this.$set(this.paymentModifyFlag,t,!this.paymentModifyFlag[t])):(this.billModifyFlag[this.modifying]&&this.billModifySwitchOff(this.modifying),this.paymentModifyFlag[this.modifying]&&this.paymentModifySwitchOff(this.modifying),this.modifying=t,this.$set(this.paymentModifyFlag,t,!this.paymentModifyFlag[t])),this.modifyPaymentRecord.paid=this.paymentDetail[t].paid,this.connectStatus=""},paymentModifySwitchOff:function(t){this.$set(this.paymentModifyFlag,t,!this.paymentModifyFlag[t]),this.modifying=-1,this.modifyPaymentRecord={}},billDeleteSwitchOn:function(t){d()("#delConfirmModal").modal({backdrop:"static"}),this.billDeleting=t},billDeleteSwitchOff:function(){this.billDeleting=-1,d()("#delConfirmModal").modal("hide")},paymentDeleteSwitchOn:function(t){d()("#delConfirmModal").modal({backdrop:"static"}),this.paymentDeleting=t},paymentDeleteSwitchOff:function(){this.paymentDeleting=-1,d()("#delConfirmModal").modal("hide")},submitNewBillRecord:function(){var t=this;this.hasClicked||(this.billCheckFormat(this.newBillRecord)?(this.hasClicked=!0,this.checkSession().then(function(i){if(i){var e={resId:t.residentDetail.id,item:t.newBillRecord.item,amount:t.newBillRecord.amount};t.connectStatus="正在上传记录...",t.axios.post(t.getAPI()+"/bill/add-record",e).then(function(i){if(100===i.data){t.connectStatus="添加成功",t.addingBillRecord=!1;var e={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/bill/detail",e,{timeout:15e3}).then(function(i){t.billDetail=[],t.billModifyFlag=[],t.billId=[];for(var e=0;e<i.data.length;e++){if(null===i.data[e].recordDate){t.recordLoadingStatus="暂无检查记录";break}t.recordLoadingStatus="";var a={item:i.data[e].item,amount:i.data[e].amount,recordDate:t.dateTimeTrim(i.data[e].recordDate)};t.billModifyFlag.push(!1),t.modifying=-1,t.billDetail.push(a),t.billId.push(i.data[e].billId)}t.loadingStatus="加载完成",t.loading=!1,t.billNPayment.totalBill+=l()(t.newBillRecord.amount),t.showAlert(!0),t.newBillRecord={}},function(i){"ECONNABORTED"===i.code&&-1!==i.toString().indexOf("timeout")?t.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(i))}),t.connectStatus=""}else 200===i.data?t.connectStatus="添加失败请重试":-999===i.data&&(t.connectStatus="服务器错误，请稍后尝试")},function(t){console.log("post info failed"),console.log(t)})}else t.hasClicked=!1,d()("#loginModal").modal("show")}),this.hasClicked=!1):alert("数据格式不正确或数据为空"))},submitModBillRecord:function(t){var i=this;this.hasClicked||(this.billCheckFormat(this.modifyBillRecord)?(this.hasClicked=!0,this.checkSession().then(function(e){if(e){i.connectStatus="正在修改";var a={resId:i.residentDetail.id,item:i.modifyBillRecord.item,amount:i.modifyBillRecord.amount,billId:i.billId[t]};i.axios.post(i.getAPI()+"/bill/modify-bill",a,{timeout:15e3}).then(function(t){if(100===t.data){i.connectStatus="修改成功",i.showAlert(!0);var e={resId:i.residentDetail.id};i.axios.post(i.getAPI()+"/bill/detail",e,{timeout:15e3}).then(function(t){i.billModifyFlag=[],i.billDetail=[],i.billId=[];for(var e=0;e<t.data.length;e++){if(null==t.data[e].recordDate){i.recordLoadingStatus="暂无记录";break}var a={item:t.data[e].item,amount:t.data[e].amount,recordDate:i.dateTimeTrim(t.data[e].recordDate)};i.billModifyFlag.push(!1),i.billDetail.push(a),i.billId.push(t.data[e].billId)}i.connectStatus=""},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(console.log("加载超时"),console.log(t)):(console.log("get failed"),console.log(t))})}else 200===t.data&&(i.connectStatus="修改失败",i.showAlert(!1),i.connectStatus="",console.log("修改失败"),console.log(t.data))},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(i.connectStatus="加载超时，请重试",i.connectStatus="",i.showAlert(!1)):(i.connectStatus="",i.showAlert(!1),console.log("post payment failed"),console.log(t))})}else d()("#loginModal").modal("show")}),this.hasClicked=!1):alert("数据格式不正确或数据为空"))},submitDelBillRecord:function(){var t=this;this.hasClicked||(this.hasClicked=!0,this.checkSession().then(function(i){if(i){t.connectStatus="正在删除";var e={resId:t.residentDetail.id,billId:t.billId[t.billDeleting]};t.axios.post(t.getAPI()+"/bill/delete-record",e,{timeout:15e3}).then(function(i){if(100===i.data){t.connectStatus="删除成功",d()("#delConfirmModal").modal("hide"),t.showAlert(!0);var e={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/bill/detail",e,{timeout:15e3}).then(function(i){t.billDetail=[],t.billModifyFlag=[],t.billId=[];for(var e=0;e<i.data.length;e++){if(null==i.data[e].recordDate){t.recordLoadingStatus="暂无记录";break}var a={item:i.data[e].item,amount:i.data[e].amount,recordDate:t.dateTimeTrim(i.data[e].recordDate)};t.billModifyFlag.push(!1),t.billDetail.push(a),t.billId.push(i.data[e].billId)}},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(console.log("加载超时"),console.log(t)):(console.log("get failed"),console.log(t))}),t.connectStatus=""}else 200===i.data&&(t.connectStatus="删除失败",d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1),console.log("删除失败"),console.log(i.data))},function(i){"ECONNABORTED"===i.code&&-1!==i.toString().indexOf("timeout")?(t.connectStatus="加载超时，请重试",d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1)):(d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1),console.log("post bill failed"),console.log(i))}),t.billDeleting=-1,t.hasClicked=!1}else d()("#loginModal").modal("show")}))},submitNewPaymentRecord:function(){var t=this;this.hasClicked||this.paymentCheckFormat(this.newPaymentRecord)&&null!=this.newPaymentRecord.paid&&(this.hasClicked=!0,this.checkSession().then(function(i){if(i){var e={resId:t.residentDetail.id,paid:t.newPaymentRecord.paid,platform:"CONSOLE"};t.connectStatus="正在上传记录...",t.axios.post(t.getAPI()+"/payment/add-record",e,{timeout:15e3}).then(function(i){if(100===i.data){t.connectStatus="添加成功",t.newPaymentRecord={},t.addingPaymentRecord=!1,t.showAlert(!0);var e={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/payment/detail",e,{timeout:15e3}).then(function(i){t.paymentDetail=[],t.paymentModifyFlag=[],t.paymentId=[];for(var e=0;e<i.data.length;e++){if(null===i.data[e].recordDate){t.recordLoadingStatus="暂无检查记录";break}t.recordLoadingStatus="";var a={paid:i.data[e].paid,platform:t.paymentPlatform(i.data[e].platform),recordDate:t.dateTimeTrim(i.data[e].recordDate)};t.paymentModifyFlag.push(!1),t.paymentDetail.push(a),t.paymentId.push(i.data[e].paymentId)}t.loadingStatus="加载完成",t.loading=!1},function(i){"ECONNABORTED"===i.code&&-1!==i.toString().indexOf("timeout")?t.loadingStatus="加载超时，请重试":(console.log("post failed"),console.log(i))}),t.connectStatus=""}else 200===i.data?(t.connectStatus="添加失败请重试",t.showAlert(!1)):-999===i.data&&(t.connectStatus="服务器错误，请稍后尝试",t.showAlert(!1))},function(i){t.connectStatus="添加失败请重试",t.showAlert(!1),console.log("post info failed"),console.log(i)})}else d()("#loginModal").modal("show")}),this.hasClicked=!1)},submitModPaymentRecord:function(t){var i=this;this.hasClicked||this.paymentCheckFormat(this.modifyPaymentRecord)&&null!=this.modifyPaymentRecord.paid&&(this.hasClicked=!0,this.checkSession().then(function(e){if(e){i.connectStatus="正在修改";var a={resId:i.residentDetail.id,paid:i.modifyPaymentRecord.paid,paymentId:i.paymentId[t]};i.axios.post(i.getAPI()+"/payment/modify-record",a,{timeout:15e3}).then(function(t){if(100===t.data){i.connectStatus="修改成功",i.showAlert(!0);var e={resId:i.residentDetail.id};i.axios.post(i.getAPI()+"/payment/detail",e,{timeout:15e3}).then(function(t){i.paymentModifyFlag=[],i.paymentId=[],i.paymentDetail=[];for(var e=0;e<t.data.length;e++){if(null==t.data[e].recordDate){i.recordLoadingStatus="暂无记录";break}var a={paid:t.data[e].paid,platform:i.paymentPlatform(t.data[e].platform),recordDate:i.dateTimeTrim(t.data[e].recordDate)};i.paymentModifyFlag.push(!1),i.paymentDetail.push(a),i.paymentId.push(t.data[e].paymentId)}i.connectStatus=""},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(console.log("加载超时"),console.log(t)):(console.log("get failed"),console.log(t))})}else 200===t.data&&(i.connectStatus="修改失败",i.showAlert(!1),i.connectStatus="",console.log("修改失败"),console.log(t.data))},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(i.connectStatus="加载超时，请重试",i.showAlert(!1)):(i.showAlert(!1),console.log("post payment failed"),console.log(t)),i.connectStatus=""})}else d()("#loginModal").modal("show")}),this.hasClicked=!1)},submitDelPaymentRecord:function(){var t=this;this.hasClicked||(this.hasClicked=!0,this.checkSession().then(function(i){if(i){t.connectStatus="正在删除";var e={resId:t.residentDetail.id,paymentId:t.paymentId[t.paymentDeleting]};t.axios.post(t.getAPI()+"/payment/delete-record",e,{timeout:15e3}).then(function(i){if(100===i.data){t.connectStatus="删除成功",d()("#delConfirmModal").modal("hide"),t.showAlert(!0);var e={resId:t.residentDetail.id};t.axios.post(t.getAPI()+"/payment/detail",e,{timeout:15e3}).then(function(i){t.paymentDetail=[],t.paymentModifyFlag=[],t.paymentId=[];for(var e=0;e<i.data.length;e++){if(null==i.data[e].recordDate){t.recordLoadingStatus="暂无记录";break}var a={paid:i.data[e].paid,platform:t.paymentPlatform(i.data[e].platform),recordDate:t.dateTimeTrim(i.data[e].recordDate)};t.paymentModifyFlag.push(!1),t.paymentDetail.push(a),t.paymentId.push(i.data[e].paymentId)}},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?(console.log("加载超时"),console.log(t)):(console.log("get failed"),console.log(t))}),t.connectStatus=""}else 200===i.data&&(t.connectStatus="删除失败",d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1),console.log("删除失败"),console.log(i.data))},function(i){"ECONNABORTED"===i.code&&-1!==i.toString().indexOf("timeout")?(t.connectStatus="加载超时，请重试",d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1)):(d()("#delConfirmModal").modal("hide"),t.connectStatus="",t.showAlert(!1),console.log("post payment failed"),console.log(i))}),t.paymentDeleting=-1,t.hasClicked=!1}else d()("#loginModal").modal("show")}))},searchBill:function(t){var i=this;t.preventDefault(),this.checkSession().then(function(t){if(t){var e={search:i.searchInput};i.axios.post(i.getAPI()+"/bill/search",e).then(function(t){i.billList=[];for(var e=0;e<t.data.length;e++){var a={id:t.data[e].resId,name:t.data[e].name,bed:t.data[e].numOfBed,totalBill:t.data[e].totalBill,totalPaid:t.data[e].totalPaid,balance:t.data[e].totalPaid-t.data[e].totalBill,latestBillDate:i.dateTimeTrim(t.data[e].latestBillDate)};"Invalid date"===a.latestBillDate&&(a.latestBillDate="暂无检查记录"),i.billList.push(a)}},function(t){console.log("search post failed"),console.log(t)})}else d()("#loginModal").modal("show")})},paymentCheckFormat:function(t){var i=/^[0-9]+(\.[0-9]{1,2})?$/;return i.test(t.paid)},billCheckFormat:function(t){if(null==t.item||null==t.amount)return!1;var i=/^[0-9]+(\.[0-9]{1,2})?$/;return t.item.length<=50&&i.test(t.amount)},dateTrim:function(t){return this.$moment(t).format("YYYY-MM-DD")},dateTimeTrim:function(t){return this.$moment(t).format("YYYY-MM-DD HH:mm:ss")},paymentPlatform:function(t){return"CONSOLE"===t?"操控台":"APP"===t?"APP":"未知平台"},countDownChanged:function(t){this.dismissCountDown=t},showAlert:function(t){this.operationSuccess=t,this.dismissCountDown=this.dismissSecs}},beforeMount:function(){this.getAllBillInfo()}},u=m,h=(e("bd93"),e("2877")),f=Object(h["a"])(u,a,o,!1,null,"00c5ef4b",null);i["default"]=f.exports},"5d6b":function(t,i,e){var a=e("e53d").parseInt,o=e("a1ce").trim,n=e("e692"),l=/^[-+]?0[xX]/;t.exports=8!==a(n+"08")||22!==a(n+"0x16")?function(t,i){var e=o(String(t),3);return a(e,i>>>0||(l.test(e)?16:10))}:a},7445:function(t,i,e){var a=e("63b6"),o=e("5d6b");a(a.G+a.F*(parseInt!=o),{parseInt:o})},a1ce:function(t,i,e){var a=e("63b6"),o=e("25eb"),n=e("294c"),l=e("e692"),s="["+l+"]",d="​",c=RegExp("^"+s+s+"*"),r=RegExp(s+s+"*$"),m=function(t,i,e){var o={},s=n(function(){return!!l[t]()||d[t]()!=d}),c=o[t]=s?i(u):l[t];e&&(o[e]=c),a(a.P+a.F*s,"String",o)},u=m.trim=function(t,i){return t=String(o(t)),1&i&&(t=t.replace(c,"")),2&i&&(t=t.replace(r,"")),t};t.exports=m},b9e9:function(t,i,e){e("7445"),t.exports=e("584a").parseInt},bd93:function(t,i,e){"use strict";var a=e("be7c"),o=e.n(a);o.a},be7c:function(t,i,e){},e692:function(t,i){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(t,i,e){t.exports=e("b9e9")}}]);
//# sourceMappingURL=chunk-20716fea.5aab94ac.js.map