(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41ee9fc5"],{"0340":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),t._m(1),a("div",{attrs:{id:"feedback-list"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-11"},[a("table",{staticClass:"table table-hover table-responsive-lg"},[t._m(2),a("tbody",[0===t.feedbackRecords.length?a("tr",[a("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"4"}},[t._v("暂无意见")])]):t._e(),t._l(t.feedbackRecords,function(e,s){return a("tr",[a("th",{attrs:{scope:"row"}},[t._v(t._s(s+1))]),t._l(e,function(e){return a("td",[t._v("\n              "+t._s(e)+"\n            ")])}),a("td",[a("button",{staticClass:"btn btn-info btn-sm",on:{click:function(e){return t.getFeedbackDetail(s)}}},[t._v("详情")])])],2)})],2)])]),a("div",{staticClass:"col-1"})])]),a("div",{staticClass:"modal fade",attrs:{id:"feedbackModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(3),a("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"modal-body",staticStyle:{"text-align":"center"}},[t._v("\n          加载中...\n        ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"modal-body"},[a("div",{attrs:{id:"feedback-detail"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-4"},[a("strong",[t._v("意见ID：")]),t._v(t._s(t.feedbackDetail.feedbackId))]),a("div",{staticClass:"col-4"},[a("strong",[t._v("标题：")]),t._v(t._s(t.feedbackDetail.feedbackTitle))]),a("div",{staticClass:"col-4"},[a("strong",[t._v("提交日期：")]),t._v(t._s(t.feedbackDetail.createDate))])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[t._m(4),a("div",{staticClass:"col-12",staticStyle:{"border-style":"solid"},attrs:{id:"feedback-content"},domProps:{innerHTML:t._s(t.feedbackDetail.feedbackContent)}})])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-10"}),a("div",{staticClass:"col-2"},[a("button",{staticClass:"btn btn-danger btn-sm",attrs:{type:"button"},on:{click:t.deleteSwitchOn}},[t._v("删除")])])])])]),t._m(5)])])]),a("div",{staticClass:"modal",attrs:{tabindex:"-1",role:"dialog",id:"delConfirmModal"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered modal-sm",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(6),t._m(7),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-danger",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.submitDeleteFeedback}},[t._v("确定")]),a("button",{staticClass:"btn btn-secondary",class:{disabled:t.hasClicked},attrs:{type:"button"},on:{click:t.deleteSwitchOff}},[t._v("取消")])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"loginModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered modal-md",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(8),a("div",{staticClass:"modal-body",attrs:{id:"loginModalBody"}},[a("LoginModal")],1)])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{attrs:{id:"panel-title"}},[a("h4",[a("strong",[t._v("意见采集")])])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"feedback-list"}},[a("strong",[t._v("意见列表")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("#")]),a("th",{attrs:{scope:"col"}},[t._v("意见标题")]),a("th",{attrs:{scope:"col"}},[t._v("提交日期")]),a("th",{attrs:{scope:"col"}},[t._v("操作")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"infoModalLabel"}},[t._v("意见详情")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",{attrs:{for:"feedback-content"}},[a("strong",[t._v("意见内容：")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("关闭")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("删除确认")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-body"},[a("p",[t._v("确认删除？该操作不可恢复")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"loginModalLabel"}},[t._v("会话超时")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],o=a("1157"),d=a.n(o),l=a("4ed9"),n={name:"feedback",components:{LoginModal:l["a"]},data:function(){return{feedbackRecords:[],feedbackRecordId:[],feedbackDetail:{feedbackId:"",feedbackTitle:"",feedbackContent:"",createDate:""},loading:!0,hasClicked:!1,detailIndex:-1}},computed:{isOnline:function(){return this.$store.getters.getOnline}},watch:{isOnline:function(){this.$store.getters.getOnline&&d()("#loginModal").modal("hide")}},methods:{getFeedbackList:function(){var t=this;this.checkSession().then(function(e){e?t.axios.get(t.getAPI()+"/feedback/list").then(function(e){t.feedbackRecords=[],t.feedbackRecordId=[];for(var a=0;a<e.data.length;a++){var s={feedbackTitle:e.data[a].feedbackTitle,createDate:t.dateTimeTrim(e.data[a].createDate)};t.feedbackRecordId.push(e.data[a].feedbackId),t.feedbackRecords.push(s)}},function(t){console.log("Get Failed"),console.log(t)}):d()("#loginModal").modal("show")})},getFeedbackDetail:function(t){var e=this;this.checkSession().then(function(a){var s={feedbackId:e.feedbackRecordId[t]};a?(e.detailIndex=t,d()("#feedbackModal").modal("show"),e.loading=!0,e.axios.post(e.getAPI()+"/feedback/detail",s).then(function(t){e.feedbackDetail.feedbackId=t.data.feedbackId,e.feedbackDetail.feedbackTitle=t.data.feedbackTitle,e.feedbackDetail.feedbackContent=t.data.feedbackContent,e.feedbackDetail.createDate=e.dateTimeTrim(t.data.createDate),e.loading=!1},function(t){})):d()("#loginModal").modal("show")})},deleteSwitchOn:function(){d()("#delConfirmModal").modal({backdrop:"static"})},deleteSwitchOff:function(){this.hasClicked||d()("#delConfirmModal").modal("hide")},submitDeleteFeedback:function(){var t=this;this.hasClicked||(this.hasClicked=!0,this.checkSession().then(function(e){if(e){var a={feedbackId:t.feedbackDetail.feedbackId};t.axios.post(t.getAPI()+"/feedback/delete",a).then(function(e){100===e.data?(d()("#delConfirmModal").modal("hide"),d()("#feedbackModal").modal("hide"),t.feedbackRecords.splice(t.detailIndex,1),t.feedbackRecordId.splice(t.detailIndex,1),t.feedbackDetail={},alert("删除成功")):200===e.data?alert("删除失败，请重试"):-999===e.data&&alert("服务器错误，请重试")},function(t){console.log("delete feedback post failed"),console.log(t)})}else d()("#loginModal").modal("show")}),this.hasClicked=!1)},dateTimeTrim:function(t){return this.$moment(t).format("YYYY-MM-DD HH:mm:ss")}},beforeMount:function(){this.getFeedbackList()}},c=n,r=(a("0ff1"),a("2877")),f=Object(r["a"])(c,s,i,!1,null,"522478b0",null);e["default"]=f.exports},"0758":function(t,e,a){},"0ff1":function(t,e,a){"use strict";var s=a("e551"),i=a.n(s);i.a},2673:function(t,e,a){"use strict";var s=a("0758"),i=a.n(s);i.a},"4ed9":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{attrs:{id:"loginFrame"}},[t._m(0),a("div",{attrs:{id:"login"}},[t.show?a("b-form",{on:{submit:t.onSubmit,reset:t.onReset}},[a("b-form-group",{attrs:{id:"userId",label:"ID:","label-for":"userIdInput"}},[a("b-form-input",{attrs:{id:"userIdInput",type:"text",required:"",placeholder:"输入ID"},model:{value:t.form.userId,callback:function(e){t.$set(t.form,"userId",e)},expression:"form.userId"}})],1),a("b-form-group",{attrs:{id:"password",label:"密码:","label-for":"passwordInput"}},[a("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"输入密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("div",{attrs:{id:"loginStatus"}},[a("span",[t._v(t._s(t.loginStatus))])]),a("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"submit",variant:"primary",size:"md"}},[t._v("登陆\n        ")]),a("b-button",{staticClass:"sub-btn",class:{disabled:t.hasClicked},attrs:{type:"reset",variant:"danger",size:"md"}},[t._v("重置\n        ")])],1):t._e()],1)])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"title"}},[a("h3",[t._v("用户登录")])])}],o=a("f499"),d=a.n(o),l=(a("6b54"),a("96cf"),a("3b8d")),n=a("c0d6"),c={data:function(){return{form:{userId:"",password:""},loginStatus:"",show:!0,hasClicked:!1}},methods:{onSubmit:function(t){var e=this;if(t.preventDefault(),!this.hasClicked){var a=/[0-9]+/;a.test(this.form.userId)?(this.hasClicked=!0,this.loginStatus="登陆中...",this.login().then(function(t){100===t?(e.loginStatus="登陆成功",e.fetchData(),e.form.userId="",e.form.password="",e.loginStatus="",e.hasClicked=!1):500===t?(e.loginStatus="账户尚未激活",e.hasClicked=!1,e.$router.push({name:"activate"})):210===t?(e.loginStatus="请求超时，请重试",e.hasClicked=!1):-999===t?(e.loginStatus="服务器开小差了，请重试",e.hasClicked=!1):(e.loginStatus="ID或密码不正确",e.hasClicked=!1)})):this.loginStatus="ID必须为数字"}},onReset:function(t){var e=this;t.preventDefault(),this.hasClicked||(this.form.userId="",this.form.password="",this.loginStatus="",this.show=!1,this.$nextTick(function(){e.show=!0}))},login:function(){var t=Object(l["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={userId:this.form.userId,password:this.form.password,platform:"CONSOLE"},a=200,t.next=4,this.axios.post(this.getAPI()+"/login",e,{timeout:15e3}).then(function(t){console.log(t.data),a=t.data},function(t){"ECONNABORTED"===t.code&&-1!==t.toString().indexOf("timeout")?a=210:(console.log("post failed"),console.log(t))});case 4:return t.abrupt("return",a);case 5:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),fetchData:function(){this.axios.get(this.getAPI()+"/user").then(function(t){localStorage.setItem("user",d()(t.data)),n["a"].commit("setUser")},function(t){console.log("post failed"),console.log(t)})}}},r=c,f=(a("2673"),a("2877")),u=Object(f["a"])(r,s,i,!1,null,"2f9c4756",null);e["a"]=u.exports},e551:function(t,e,a){}}]);
//# sourceMappingURL=chunk-41ee9fc5.08c8f3ce.js.map